!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=r(e,t);if(o){var a=Object.getOwnPropertyDescriptor(o,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}}).apply(this,arguments)}function r(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(self.webpackChunkrugs=self.webpackChunkrugs||[]).push([[575],{89575:function(r,c,u){"use strict";u.r(c),u.d(c,{WalletConnectV1Adapter:function(){return g}});var l=u(16304),d=u(5587),p=u(49418),f=u(77702),h=u(50520),v=[{name:"Rainbow",chains:[f.EN.EIP155],logo:"https://images.web3auth.io/login-rainbow.svg",mobile:{native:"rainbow:",universal:"https://rnbwapp.com"},desktop:{native:"",universal:""}},{name:"MetaMask",chains:[f.EN.EIP155],logo:"https://images.web3auth.io/login-metamask.svg",mobile:{native:"metamask:",universal:"https://metamask.app.link"},desktop:{native:"",universal:""}}];function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var g=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(m,r);var c,u,g,y=a(m);function m(){var t;e(this,m);var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=y.call(this),(0,d.Z)(i(t),"name",f.rW.WALLET_CONNECT_V1),(0,d.Z)(i(t),"adapterNamespace",f.yk.EIP155),(0,d.Z)(i(t),"currentChainNamespace",f.EN.EIP155),(0,d.Z)(i(t),"type",f.hN.EXTERNAL),(0,d.Z)(i(t),"adapterOptions",void 0),(0,d.Z)(i(t),"status",f.MP.NOT_READY),(0,d.Z)(i(t),"adapterData",{uri:"",extensionAdapters:v}),(0,d.Z)(i(t),"connector",null),(0,d.Z)(i(t),"wcProvider",null),(0,d.Z)(i(t),"rehydrated",!1),t.adapterOptions=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){(0,d.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n),t.chainConfig=n.chainConfig||null,t}return c=m,(u=[{key:"connected",get:function(){var e;return!(null===(e=this.connector)||void 0===e||!e.connected)}},{key:"provider",get:function(){var e;return(null===(e=this.wcProvider)||void 0===e?void 0:e.provider)||null},set:function(e){throw new Error("Not implemented")}},{key:"init",value:function(){var e=this,t=this;return(0,l.Z)(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n(s(m.prototype),"checkInitializationRequirements",e).call(t),t.chainConfig||(t.chainConfig=(0,f.h2)(f.EN.EIP155,1)),t.connector=t.getWalletConnectInstance(),t.wcProvider=new h.WalletConnectProvider({config:{chainConfig:t.chainConfig},connector:t.connector}),t.emit(f.n2.READY,f.rW.WALLET_CONNECT_V1),t.status=f.MP.READY,f.cM.debug("initializing wallet connect v1 adapter"),r.t0=t.connector.connected,!r.t0){r.next=12;break}return t.rehydrated=!0,r.next=12,t.onConnectHandler({accounts:t.connector.accounts,chainId:t.connector.chainId});case 12:case"end":return r.stop()}},r)}))()}},{key:"connect",value:function(){var e=this,t=this;return(0,l.Z)(regeneratorRuntime.mark(function r(){var o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n(s(m.prototype),"checkConnectionRequirements",e).call(t),t.connector){r.next=2;break}throw f.Ty.notReady("Wallet adapter is not ready yet");case 2:if(!t.connected){r.next=8;break}return r.next=5,t.onConnectHandler({accounts:t.connector.accounts,chainId:t.connector.chainId});case 5:r.t0=t.provider,r.next=16;break;case 8:if(r.t1=t.status!==f.MP.CONNECTING,!r.t1){r.next=15;break}return null!==(o=t.adapterOptions.adapterSettings)&&void 0!==o&&o.qrcodeModal&&(t.connector=t.getWalletConnectInstance(),t.wcProvider=new h.WalletConnectProvider({config:{chainConfig:t.chainConfig,skipLookupNetwork:null===(a=t.adapterOptions.adapterSettings)||void 0===a?void 0:a.skipNetworkSwitching},connector:t.connector})),r.next=13,t.createNewSession();case 13:t.status=f.MP.CONNECTING,t.emit(f.n2.CONNECTING,{adapter:f.rW.WALLET_CONNECT_V1});case 15:r.t0=new Promise(function(e,n){if(!t.connector)return n(f.Ty.notReady("Wallet adapter is not ready yet"));t.connector.on("modal_closed",(0,l.Z)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t.status=f.MP.READY,t.emit(f.n2.READY,f.rW.WALLET_CONNECT_V1),n(new Error("User closed modal"))));case 1:case"end":return e.stop()}},e)})));try{t.connector.on("connect",(r=(0,l.Z)(regeneratorRuntime.mark(function n(r,o){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r&&t.emit(f.n2.ERRORED,r),f.cM.debug("connected event emitted by web3auth"),n.next=4,t.onConnectHandler(o.params[0]);case 4:return n.abrupt("return",e(t.provider));case 5:case"end":return n.stop()}},n)})),function(e,t){return r.apply(this,arguments)}))}catch(o){f.cM.error("Wallet connect v1 adapter error while connecting",o),t.status=f.MP.READY,t.rehydrated=!0,t.emit(f.n2.ERRORED,o),n(o instanceof f.up?o:f.RM.connectionError("Failed to login with wallet connect: ".concat((null==o?void 0:o.message)||"")))}var r});case 16:return r.abrupt("return",r.t0);case 17:case"end":return r.stop()}},r)}))()}},{key:"getUserInfo",value:function(){var e=this;return(0,l.Z)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.connected){t.next=2;break}throw f.RM.notConnectedError("Not connected with wallet, Please login/connect first");case 2:return t.abrupt("return",{});case 3:case"end":return t.stop()}},t)}))()}},{key:"disconnect",value:function(){var e=arguments,t=this;return(0,l.Z)(regeneratorRuntime.mark(function n(){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:{cleanup:!1},o=r.cleanup,t.connector&&t.connected){n.next=4;break}throw f.RM.notConnectedError("Not connected with wallet");case 4:return n.next=6,t.connector.killSession();case 6:t.rehydrated=!1,o?(t.connector=null,t.status=f.MP.NOT_READY,t.wcProvider=null):t.status=f.MP.READY,t.emit(f.n2.DISCONNECTED);case 9:case"end":return n.stop()}},n)}))()}},{key:"addChain",value:function(e){var t=this;return(0,l.Z)(regeneratorRuntime.mark(function n(){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t.wcProvider){n.next=3;break}throw f.Ty.notReady("Wallet adapter is not ready yet");case 3:if(o=null===(r=t.adapterOptions.adapterSettings)||void 0===r?void 0:r.networkSwitchModal,n.t0=o,!n.t0){n.next=8;break}return n.next=8,o.addNetwork({chainConfig:e,appOrigin:window.location.hostname});case 8:return n.next=10,t.wcProvider.addChain(e);case 10:n.next=15;break;case 12:n.prev=12,n.t1=n.catch(0),f.cM.error(n.t1);case 15:case"end":return n.stop()}},n,null,[[0,12]])}))()}},{key:"switchChain",value:function(e,t){var n=this;return(0,l.Z)(regeneratorRuntime.mark(function r(){var o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.wcProvider){r.next=2;break}throw f.Ty.notReady("Wallet adapter is not ready yet");case 2:if(a=null===(o=n.adapterOptions.adapterSettings)||void 0===o?void 0:o.networkSwitchModal,r.t0=a,!r.t0){r.next=7;break}return r.next=7,a.switchNetwork({currentChainConfig:t,newChainConfig:e,appOrigin:window.location.hostname});case 7:return r.next=9,n.wcProvider.switchChain({chainId:t.chainId,lookup:!1,addChain:!1});case 9:case"end":return r.stop()}},r)}))()}},{key:"createNewSession",value:function(){var e=arguments,t=this;return(0,l.Z)(regeneratorRuntime.mark(function n(){var r,o,a,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{forceNewSession:!1},t.connector){n.next=3;break}throw f.Ty.notReady("Wallet adapter is not ready yet");case 3:if(n.t0=a.forceNewSession&&t.connector.pending,!n.t0){n.next=7;break}return n.next=7,t.connector.killSession();case 7:if(null!==(r=t.adapterOptions)&&void 0!==r&&null!==(o=r.adapterSettings)&&void 0!==o&&o.qrcodeModal){n.next=9;break}return n.abrupt("return",new Promise(function(e,n){var r,o;if(!t.connector)return n(f.Ty.notReady("Wallet adapter is not ready yet"));f.cM.debug("creating new session for web3auth wallet connect"),t.connector.on("display_uri",(o=(0,l.Z)(regeneratorRuntime.mark(function r(o,a){var c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",o?(t.emit(f.n2.ERRORED,f.RM.connectionError("Failed to display wallet connect qr code")),n(o)):(t.updateAdapterData({uri:a.params[0],extensionAdapters:v}),null===(c=t.connector)||void 0===c||c.off("display_uri"),e()));case 1:case"end":return r.stop()}},r)})),function(e,t){return o.apply(this,arguments)})),t.connector.createSession({chainId:parseInt((null===(r=t.chainConfig)||void 0===r?void 0:r.chainId)||"0x1",16)}).catch(function(e){return f.cM.error("error while creating new wallet connect session",e),t.emit(f.n2.ERRORED,e),n(e)})}));case 9:return n.next=11,t.connector.createSession({chainId:parseInt((null===(c=t.chainConfig)||void 0===c?void 0:c.chainId)||"0x1",16)});case 11:case"end":return n.stop()}},n)}))()}},{key:"onConnectHandler",value:function(e){var t=this;return(0,l.Z)(regeneratorRuntime.mark(function n(){var r,o,a,c,i,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.connector&&t.wcProvider){n.next=2;break}throw f.Ty.notReady("Wallet adapter is not ready yet");case 2:if(t.chainConfig){n.next=4;break}throw f.Ty.invalidParams("Chain config is not set");case 4:if(r=e.chainId,f.cM.debug("connected chainId in hex"),r===parseInt(t.chainConfig.chainId,16)){n.next=24;break}if(i=(0,f.h2)(f.EN.EIP155,r)||{chainId:"0x".concat(r.toString(16)),displayName:"Unknown Network"},(s=null===(o=t.adapterOptions.adapterSettings)||void 0===o?void 0:o.qrcodeModal)&&(!s||null!==(a=t.adapterOptions)&&void 0!==a&&null!==(c=a.adapterSettings)&&void 0!==c&&c.skipNetworkSwitching)){n.next=24;break}return n.prev=8,n.next=11,t.addChain(t.chainConfig);case 11:return n.next=13,t.switchChain(i,t.chainConfig);case 13:t.connector=t.getWalletConnectInstance(),n.next=24;break;case 16:return n.prev=16,n.t0=n.catch(8),f.cM.error("error while chain switching",n.t0),n.next=21,t.createNewSession({forceNewSession:!0});case 21:return t.emit(f.n2.ERRORED,f.Ty.fromCode(5e3,"Not connected to correct network. Expected: ".concat(t.chainConfig.displayName,", Current: ").concat((null==i?void 0:i.displayName)||r,", Please switch to correct network from wallet"))),t.status=f.MP.READY,n.abrupt("return",void(t.rehydrated=!0));case 24:return n.next=26,t.wcProvider.setupProvider(t.connector);case 26:t.subscribeEvents(t.connector),t.status=f.MP.CONNECTED,t.emit(f.n2.CONNECTED,{adapter:f.rW.WALLET_CONNECT_V1,reconnected:t.rehydrated});case 29:case"end":return n.stop()}},n,null,[[8,16]])}))()}},{key:"subscribeEvents",value:function(e){var t,n=this;e.on("session_update",(t=(0,l.Z)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&n.emit(f.n2.ERRORED,t);case 1:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}))}},{key:"getWalletConnectInstance",value:function(){var e=this.adapterOptions.adapterSettings||{};return e.bridge=e.bridge||"https://bridge.walletconnect.org",new p.Z(e)}}])&&t(c.prototype,u),g&&t(c,g),m}(f.J5)}}])}();